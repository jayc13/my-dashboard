[build]
builder = "NIXPACKS"
buildCommand = "./scripts/railway-build.sh"
#watchPatterns = ["server/**"]

[variables]
NODE_VERSION = "22"

[source]
repo = "jayc13/my-dashboard"
branch = "main"
rootDirectory = ""

[deploy]
runtime = "V2"
numReplicas = 1
startCommand = "cd server && npm start"
healthcheckPath = "/health"
preDeployCommand = ["cd server && npm run migrate"]
sleepApplication = false
useLegacyStacker = false
restartPolicyType = "ON_FAILURE"
healthcheckTimeout = 5000
restartPolicyMaxRetries = 3